"use strict";var self=this;if(self.URL=self.URL||self.webkitURL,self.requestFileSystem=self.requestFileSystem||self.webkitRequestFileSystem,self.resolveLocalFileSystemURL=self.resolveLocalFileSystemURL||self.webkitResolveLocalFileSystemURL,navigator.temporaryStorage=navigator.temporaryStorage||navigator.webkitTemporaryStorage,navigator.persistentStorage=navigator.persistentStorage||navigator.webkitPersistentStorage,self.BlobBuilder=self.BlobBuilder||self.MozBlobBuilder||self.WebKitBlobBuilder,void 0===self.FileError){var FileError=function(){};FileError.prototype.prototype=Error.prototype}var Util={toArray:function(a){return Array.prototype.slice.call(a||[],0)},strToDataURL:function(a,b,c){var d=void 0!=c?c:!0;return d?"data:"+b+";base64,"+self.btoa(a):"data:"+b+","+a},strToObjectURL:function(a,b){for(var c=new Uint8Array(a.length),d=0;d<c.length;++d)c[d]=a.charCodeAt(d);var e=new Blob([c],b?{type:b}:{});return self.URL.createObjectURL(e)},fileToObjectURL:function(a){return self.URL.createObjectURL(a)},fileToArrayBuffer:function(a,b,c){var d=new FileReader;d.onload=function(a){b(a.target.result)},d.onerror=function(a){c&&c(a)},d.readAsArrayBuffer(a)},dataURLToBlob:function(a){var b=";base64,";if(-1==a.indexOf(b)){var c=a.split(","),d=c[0].split(":")[1],e=c[1];return new Blob([e],{type:d})}for(var c=a.split(b),d=c[0].split(":")[1],e=window.atob(c[1]),f=e.length,g=new Uint8Array(f),h=0;f>h;++h)g[h]=e.charCodeAt(h);return new Blob([g],{type:d})},arrayBufferToBlob:function(a,b){var c=new Uint8Array(a);return new Blob([c],b?{type:b}:{})},arrayBufferToBinaryString:function(a,b,c){var d=new FileReader;d.onload=function(a){b(a.target.result)},d.onerror=function(a){c&&c(a)};var e=new Uint8Array(a);d.readAsBinaryString(new Blob([e]))},arrayToBinaryString:function(a){if(typeof a!=typeof[])return null;for(var b=a.length,c=new Array(b);b--;)c[b]=String.fromCharCode(a[b]);return c.join("")},getFileExtension:function(a){var b=a.lastIndexOf(".");return-1!=b?a.substring(b):""}},MyFileError=function(a){this.prototype=FileError.prototype,this.code=a.code,this.name=a.name};FileError.BROWSER_NOT_SUPPORTED=1e3,FileError.prototype.__defineGetter__("name",function(){for(var c,a=Object.keys(FileError),b=0;c=a[b];++b)if(FileError[c]==this.code)return c;return"Unknown Error"});var Filer=new function(){function o(a){g=a||null,g&&(h=g.root,i=!0)}var a="Filesystem has not been initialized.",b="Not implemented.",c="Path was not a directory.",d="These method arguments are not supported.",e="filesystem:",f=1048576,g=null,h=null,i=!1,j=function(a){return 0==a.indexOf(e)},k=function(a){return j(a)||(a="/"==a[0]?g.root.toURL()+a.substring(1):0==a.indexOf("./")||0==a.indexOf("../")?"../"==a&&h!=g.root?h.toURL()+"/"+a:h.toURL()+a:h.toURL()+"/"+a),a},l=function(a){var c=arguments[1],d=arguments[2],e=function(a){throw a.code==FileError.NOT_FOUND_ERR?d?new Error('"'+c+'" or "'+d+'" does not exist.'):new Error('"'+c+'" does not exist.'):new Error("Problem getting Entry for one or more paths.")};"undefined"!=typeof opt_onError&&(e=opt_onError);var f=k(c);if(3==arguments.length){var g=k(d);self.resolveLocalFileSystemURL(f,function(b){self.resolveLocalFileSystemURL(g,function(c){a(b,c)},e)},e)}else self.resolveLocalFileSystemURL(f,a,e)},m=function(a,b){var d=arguments[2],e=arguments[3],f=function(a){throw a.code==FileError.NOT_FOUND_ERR?e?new Error('"'+d+'" or "'+e+'" does not exist.'):new Error('"'+d+'" does not exist.'):new Error("Problem getting Entry for one or more paths.")};"undefined"!=typeof b&&(f=b);var g=k(d);if(4==arguments.length){var h=k(e);self.resolveLocalFileSystemURL(g,function(b){self.resolveLocalFileSystemURL(h,function(c){a(b,c)},f)},f)}else self.resolveLocalFileSystemURL(g,a,f)},n=function(b,c,e,f,h,i){if(!g)throw new Error(a);if(typeof b!=typeof c)throw new Error(d);var k=e||null,m=void 0!=i?i:!1;(b.isFile||c.isDirectory)&&c.isDirectory?m?b.moveTo(c,k,f,h):b.copyTo(c,k,f,h):l(function(a,b){if(!b.isDirectory){var c=new Error('Oops! "'+b.name+" is not a directory!");if(!h)throw c;return h(c),void 0}m?a.moveTo(b,k,f,h):a.copyTo(b,k,f,h)},b,c)};return o.DEFAULT_FS_SIZE=f,o.version="0.4.3",o.prototype={get fs(){return g},get isOpen(){return i},get cwd(){return h}},o.prototype.pathToFilesystemURL=function(a){return k(a)},o.prototype.init=function(a,b,c){if(!self.requestFileSystem)throw new MyFileError({code:FileError.BROWSER_NOT_SUPPORTED,name:"BROWSER_NOT_SUPPORTED"});var d=a?a:{},e=d.size||f;this.type=self.TEMPORARY,"persistent"in d&&d.persistent&&(this.type=self.PERSISTENT);var j=function(a){this.size=e,g=a,h=g.root,i=!0,b&&b(a)};this.type==self.PERSISTENT&&navigator.persistentStorage?navigator.persistentStorage.requestQuota(e,function(a){self.requestFileSystem(this.type,a,j.bind(this),c)}.bind(this),c):self.requestFileSystem(this.type,e,j.bind(this),c)},o.prototype.ls=function(b,c,d){if(!g)throw new Error(a);var e=function(a){h=a;var b=[],e=h.createReader(),f=function(){e.readEntries(function(a){a.length?(b=b.concat(Util.toArray(a)),f()):(b.sort(function(a,b){return a.name<b.name?-1:b.name<a.name?1:0}),c(b))},d)};f()};b.isDirectory?e(b):j(b)?l(e,k(b)):h.getDirectory(b,{},e,d)},o.prototype.mkdir=function(b,c,d,e){if(!g)throw new Error(a);var f=null!=c?c:!1,i=b.split("/"),j=function(a,c){("."==c[0]||""==c[0])&&(c=c.slice(1)),a.getDirectory(c[0],{create:!0,exclusive:f},function(a){if(a.isDirectory)c.length&&1!=i.length?j(a,c.slice(1)):d&&d(a);else{var f=new Error(b+" is not a directory");if(!e)throw f;e(f)}},function(a){if(a.code==FileError.INVALID_MODIFICATION_ERR){if(a.message="'"+b+"' already exists",!e)throw a;e(a)}})};j(h,i)},o.prototype.open=function(b,c,d){if(!g)throw new Error(a);b.isFile?b.file(c,d):m(function(a){a.file(c,d)},d,k(b))},o.prototype.create=function(b,c,d,e){if(!g)throw new Error(a);var f=null!=c?c:!0;h.getFile(b,{create:!0,exclusive:f},d,function(a){if(a.code==FileError.INVALID_MODIFICATION_ERR&&(a.message="'"+b+"' already exists"),!e)throw a;e(a)})},o.prototype.mv=function(a,b,c,d,e){n.bind(this,a,b,c,d,e,!0)()},o.prototype.rm=function(b,c,d){if(!g)throw new Error(a);var e=function(a){a.isFile?a.remove(c,d):a.isDirectory&&a.removeRecursively(c,d)};b.isFile||b.isDirectory?e(b):l(e,b)},o.prototype.cd=function(b,d,e){if(!g)throw new Error(a);if(b.isDirectory)h=b,d&&d(h);else{var b=k(b);l(function(a){if(a.isDirectory)h=a,d&&d(h);else{var b=new Error(c);if(!e)throw b;e(b)}},b)}},o.prototype.cp=function(a,b,c,d,e){n.bind(this,a,b,c,d,e)()},o.prototype.write=function(b,c,d,e){if(!g)throw new Error(a);var f=function(a){a.createWriter(function(b){if(b.onerror=e,c.append)b.onwriteend=function(){d&&d(a,this)},b.seek(b.length);else{var f=!1;b.onwriteend=function(){return f?(d&&d(a,this),void 0):(f=!0,this.truncate(this.position),void 0)}}c.data.__proto__==ArrayBuffer.prototype&&(c.data=new Uint8Array(c.data));var g=new Blob([c.data],c.type?{type:c.type}:{});b.write(g)},e)};b.isFile?f(b):j(b)?l(f,b):h.getFile(b,{create:!0,exclusive:!1},f,e)},o.prototype.df=function(a,c){var d=function(b,c){a(b,c-b,c)};if(!navigator.temporaryStorage.queryUsageAndQuota||!navigator.persistentStorage.queryUsageAndQuota)throw new Error(b);self.TEMPORARY==this.type?navigator.temporaryStorage.queryUsageAndQuota(d,c):self.PERSISTENT==this.type&&navigator.persistentStorage.queryUsageAndQuota(d,c)},o};