function Pair(a,b){this.x=a,this.y=b}var gj=gj||{};gj.divide=function(a,b,c,d){for(var e=c+1;d>e;e++)a[b][e]/=a[b][c];a[b][c]=1},gj.eliminate=function(a,b,c,d,e){for(var f=0;d>f;f++)if(f!=b&&0!=a[f][c]){for(var g=c+1;e>g;g++)a[f][g]-=a[f][c]*a[b][g];a[f][c]=0}},gj.echelonize=function(a){for(var f,g,b=a.length,c=a[0].length,d=0,e=0;b>d&&c>e;){for(f=d;b>f&&0==a[f][e];)f++;b>f&&(f!=d&&(g=a[d],a[d]=a[f],a[f]=g),1!=a[d][e]&&gj.divide(a,d,e,c),gj.eliminate(a,d,e,b,c),d++),e++}},Pair.prototype.toString=function(){return x+","+y};var matf=matf||{};matf.number_format=function(a,b,c){for(s=a.toExponential(b);s.length<c;)s=" "+s;return s},matf.regress=function(a,b){for(var c=0,d=0,e=0;e<b.length;e++)term=b[e],c+=term*Math.pow(a,d),d++;return c},matf.corr_coeff=function(a,b){for(var j,k,c=0,d=a.length,e=0,f=0,g=0,h=0,i=0,l=0;l<a.length;l++){pr=a[l];var j=matf.regress(pr.x,b),k=pr.y;e+=j,g+=k,i+=j*k,f+=j*j,h+=k*k}var m=Math.sqrt((f-e*e/d)*(h-g*g/d));return 0!=m&&(c=Math.pow((i-e*g/d)/m,2)),c},matf.std_error=function(a,b){var c=0,d=a.length;if(d>2){for(var e=0,f=0;f<a.length;f++)pr=a[f],e+=Math.pow(matf.regress(pr.x,b)-pr.y,2);c=Math.sqrt(e/(d-2))}return c},matf.compute_coefficients=function(a,b){b+=1;var d,e,c=a.length,f=2*b-1;m=Array();for(var g=0;b>g;g++){mm=Array();for(var h=0;b>=h;h++)mm[h]=0;m[g]=mm}mpc=Array();for(var g=0;f>g;g++)mpc[g]=0;mpc[0]=c;for(var g=0;g<a.length;g++){for(pr=a[g],d=1;f>d;d++)mpc[d]+=Math.pow(pr.x,d);for(m[0][b]+=pr.y,d=1;b>d;d++)m[d][b]+=Math.pow(pr.x,d)*pr.y}for(d=0;b>d;d++)for(e=0;b>e;e++)m[d][e]=mpc[d+e];gj.echelonize(m),terms=Array();for(var g=0;g<m.length;g++)mc=m[g],terms[g]=mc[b];return terms},matf.test=function(){var a=[-1,0,1,2,3,5,7,9],b=[-1,3,2.5,5,4,2,5,4];data=Array();for(var c=0;c<a.length;c++)data[c]=new Pair(a[c],b[c]);terms=compute_coefficients(data,6);for(var d=16,e=24,c=0;c<terms.length;c++)print(number_format(terms[c],d,e)+" * x^"+c);cc=corr_coeff(data,terms),print("cc = "+number_format(cc,d,e)),se=std_error(data,terms),print("se = "+number_format(se,d,e))},matf.process_data=function(a,b){var c=matf.compute_coefficients(a,b),d=matf.corr_coeff(a,c),e=matf.std_error(a,c);return[c,d,e]};